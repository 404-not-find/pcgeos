<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>

<!-- $Id: VM_10.htm,v 1.1 97/06/02 15:53:30 lawrence Exp $ -->
<META NAME="copyright" CONTENT="Copyright 1997 GEOWORKS">
<!-- <META NAME="description" CONTENT=""> -->
<!-- <META NAME="keywords" CONTENT=""> -->
<LINK REL="STYLESHEET" HREF="../../docHelpers/style.css">
<LINK REV="MADE" HREF="mailto:doc-feedback@geoworks.com">

<TITLE> Closing Files</TITLE></HEAD>
<BODY BGCOLOR="#ffffff">


<H1 CLASS="subsectionTitle">
<A HREF="index.htm">Virtual Memory</A>: 3.9 <A HREF="VM_7.htm">Using Virtual Memory</A>: 
Closing Files</H1>
<!-- This blob is a bunch of standard links: up, back, index, etc. -->
<!-- up to top -->|&nbsp;<A HREF="../../index.htm"><IMG SRC="../../docImages/upTop.gif" ALT="Up: " BORDER="0">GEOS SDK TechDocs</A>
<!-- up to parent -->| <A HREF="VM_7.htm"><IMG SRC="../../docImages/up.gif" ALT="Up" BORDER="0"></A>
<!-- down to first child --> 
<!-- to previous --> | <A HREF="VM_f.htm"><IMG SRC="../../docImages/prev.gif" BORDER="0" ALT="Prev: ">3.8 Updating and Saving Files</A> 
<!-- to next --> | <A HREF="VM_11.htm"><IMG SRC="../../docImages/next.gif" BORDER="0" ALT="Next: ">3.10 The VM File's Map Block</A> 
<HR>
<!-- That blob was a bunch of standard links: up, back, index, etc. -->
<PRE>VMClose()</PRE>
<P>
<A NAME="IX_VMClose()">
 </A>
When you are done with a VM file for the time being, you should close it with <CODE>
VMClose()</CODE>
. This routine updates all the dirty blocks, frees all the global memory blocks attached to the file, and closes the file (thus freeing its handle). The routine is passed two arguments. The first is the handle of the file to close. The second is a flag, <CODE>
noErrorFlag</CODE>
. If this flag is FILE_NO_ERROR, <CODE>
VMClose()</CODE>
 will not return error conditions; if it could not successfully close the file, it will fatal-error.</P>
<P>
If <CODE>
noErrorFlag</CODE>
 is <EM>
false</EM>
 (i.e., zero), <CODE>
VMClose()</CODE>
 will update the file and close it. If the file could not be updated, it will return an error condition. Be warned, however, that if for some reason<CODE>
 VMClose()</CODE>
 could not finish updating a file (for example, because the disk ran out of space), <CODE>
VMClose()</CODE>
 will return an error message, but will close the file and free the memory anyway. Thus, the most recent changes will be lost. For this reason, it is usually safer to first update the file (and handle any error messages returned) and then close it.</P>
<P>
When GEOS shuts down, all files are closed. When it restarts, you can open the files manually. </P>
<P>
If the file is backup-enabled, the backup blocks will be preserved until the file is next opened. That means, for example, that the next time you open the file, you can continue working on it normally, or you can immediately revert it to its condition as of the last time it was saved (in the earlier GEOS session).</P>
<HR>
<!-- This blob is a bunch of standard links: up, back, index, etc. -->
<!-- up to top -->|&nbsp;<A HREF="../../index.htm"><IMG SRC="../../docImages/upTop.gif" ALT="Up: " BORDER="0">GEOS SDK TechDocs</A>
<!-- up to parent -->| <A HREF="VM_7.htm"><IMG SRC="../../docImages/up.gif" ALT="Up" BORDER="0"></A>
<!-- down to first child --> 
<!-- to previous --> | <A HREF="VM_f.htm"><IMG SRC="../../docImages/prev.gif" BORDER="0" ALT="Prev: ">3.8 Updating and Saving Files</A> 
<!-- to next --> | <A HREF="VM_11.htm"><IMG SRC="../../docImages/next.gif" BORDER="0" ALT="Next: ">3.10 The VM File's Map Block</A> 
<HR>
<!-- That blob was a bunch of standard links: up, back, index, etc. -->
</BODY>
</HTML>
