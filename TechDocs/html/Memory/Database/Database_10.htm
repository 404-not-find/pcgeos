<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>

<!-- $Id: Database_10.htm,v 1.1 97/06/06 14:56:45 lawrence Exp $ -->
<META NAME="copyright" CONTENT="Copyright 1997 GEOWORKS">
<!-- <META NAME="description" CONTENT=""> -->
<!-- <META NAME="keywords" CONTENT=""> -->
<LINK REL="STYLESHEET" HREF="../../docHelpers/style.css">
<LINK REV="MADE" HREF="mailto:doc-feedback@geoworks.com">

<TITLE> Other DB Utilities</TITLE></HEAD>
<BODY BGCOLOR="#ffffff">


<H1 CLASS="subsectionTitle">
<A HREF="index.htm">Database</A>: 3.8 <A HREF="Database_8.htm">Using Database Routines</A>: 
<A NAME="77102">
 </A>
Other DB Utilities</H1>
<!-- This blob is a bunch of standard links: up, back, index, etc. -->
<!-- up to top -->|&nbsp;<A HREF="../../index.htm"><IMG SRC="../../docImages/upTop.gif" ALT="Up: " BORDER="0">GEOS SDK TechDocs</A>
<!-- up to parent -->| <A HREF="Database_8.htm"><IMG SRC="../../docImages/up.gif" ALT="Up" BORDER="0"></A>
<!-- down to first child --> 
<!-- to previous --> | <A HREF="Database_f.htm"><IMG SRC="../../docImages/prev.gif" BORDER="0" ALT="Prev: ">3.7 Routines for Ungrouped Items</A> 
<!-- to next --> 
<HR>
<!-- That blob was a bunch of standard links: up, back, index, etc. -->
<PRE>DBCopyDBItem(), DBCopyDBItemUngrouped(), DBGroupFromGroupAndItem(), DBItemFromGroupAndItem(), DBCombineGroupAndItem()</PRE>
<P>
<A NAME="IX_DBCopyDBItem()">
 </A>
You can duplicate a DB item with the routine <CODE>
DBCopyDBItem()</CODE>
. This routine takes five arguments: the handle of the source file, the source item's group-handle, the source item's item-handle, the handle of the destination file (which may be the same as the source file), and the handle of the destination group. The routine will allocate a new item in the specified file and group. It will then lock both items and copy the data from the source item to the destination. Finally, it will unlock both items and return the item-handle of the duplicate item.</P>
<P>
<A NAME="IX_DBCopyDBItemUngrouped()">
 </A>
The routine <CODE>
DBCopyDBItemUngrouped()</CODE>
 is the same as <CODE>
DBCopyDBItem()</CODE>
, except that it allocates an ungrouped item in the specified file. It is passed the source file handle, the <CODE>
DBGroupAndItem</CODE>
 value for the source item, and the destination file handle. It allocates an ungrouped item and returns its<CODE>
 DBGroupAndItem</CODE>
 value.</P>
<P>
Remember, if you are allocating the duplicate in the same group as the source, you should only call this routine when the source item is unlocked (since its item-block may be compacted when the new item is allocated). If the destination is in another block, the source item may be locked or unlocked at your preference. If it is locked when you call <CODE>
DBCopyDBItem()</CODE>
, it will be locked when the routine returns.</P>
<P>
All of the VM chain utilities work on DB items as well as VM chains. The routines are described in <A HREF="../../Memory/VM/VM_14.htm#87156">the VM chapter</A>. To use a VM chain routine, pass the item's <CODE>DBGroupAndItem</CODE>
 value. For example, <CODE>
VMCopyVMChain()</CODE>
 will allocate an &quot;ungrouped&quot; duplicate item in the specified file and return its <CODE>
DBGroupAndItem</CODE>
 value.</P>
<P>
<A NAME="IX_DBCombineGroupAndItem() macro">
 </A>
To build a <CODE>
DBGroupAndItem</CODE>
 value from the group-handle and item-handle, use the macro <CODE>
DBCombineGroupAndItem()</CODE>
. This macro takes the two handles and returns a <CODE>
DBGroupAndItem</CODE>
 value. To extract the component handles from a <CODE>
DBGroupAndItem</CODE>
 value, use the macros <CODE>
DBGroupFromGroupAndItem()</CODE>
<A NAME="IX_DBGroupFromGroupAndItem() macro">
 </A>
 and<A NAME="IX_DBItemFromGroupAndItem() macro">
 </A>
 <CODE>
DBItemFromGroupAndItem()</CODE>
. These macros are passed a <CODE>
DBGroupAndItem</CODE>
 value and return the appropriate component.</P>
<P>
&nbsp;</P>
<HR>
<!-- This blob is a bunch of standard links: up, back, index, etc. -->
<!-- up to top -->|&nbsp;<A HREF="../../index.htm"><IMG SRC="../../docImages/upTop.gif" ALT="Up: " BORDER="0">GEOS SDK TechDocs</A>
<!-- up to parent -->| <A HREF="Database_8.htm"><IMG SRC="../../docImages/up.gif" ALT="Up" BORDER="0"></A>
<!-- down to first child --> 
<!-- to previous --> | <A HREF="Database_f.htm"><IMG SRC="../../docImages/prev.gif" BORDER="0" ALT="Prev: ">3.7 Routines for Ungrouped Items</A> 
<!-- to next --> 
<HR>
<!-- That blob was a bunch of standard links: up, back, index, etc. -->
</BODY>
</HTML>
