<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>

<!-- $Id: R_e.htm,v 1.2 97/06/25 18:48:35 lawrence Exp $ -->
<META NAME="copyright" CONTENT="Copyright 1997 GEOWORKS">
<!-- <META NAME="description" CONTENT=""> -->
<!-- <META NAME="keywords" CONTENT=""> -->
<LINK REL="STYLESHEET" HREF="../../docHelpers/style.css">
<LINK REV="MADE" HREF="mailto:doc-feedback@geoworks.com">

<TITLE>GEOS C Routines: ContactGetDBHandle() ...</TITLE></HEAD>
<BODY BGCOLOR="#ffffff">
<DIV>
<!-- This blob is a bunch of standard links: up, back, index, etc. -->
<!-- up to top -->|&nbsp;<A HREF="../../index.htm"><IMG SRC="../../docImages/upTop.gif" ALT="Up: " BORDER="0">GEOS SDK TechDocs</A>
<!-- up to parent -->| <A HREF="index.htm"><IMG SRC="../../docImages/up.gif" ALT="Up" BORDER="0"></A>
<!-- down to first child --> 
<!-- to previous --> | <A HREF="R_d.htm"><IMG SRC="../../docImages/prev.gif" BORDER="0" ALT="Prev: ">ConstructOptr() ...</A> 
<!-- to next --> | <A HREF="R_f.htm"><IMG SRC="../../docImages/next.gif" BORDER="0" ALT="Next: ">ContactMatchNumber() ...</A> 
<HR>
<!-- That blob was a bunch of standard links: up, back, index, etc. -->
</DIV>
<DIV>
<A NAME="IX_ContactGetDBHandle()">
 </A>
<H1 CLASS="refHeading">
ContactGetDBHandle()</H1>
<PRE CLASS="syntax">VMFileHandle 	ContactGetDBHandle( void );</PRE>
<P>
This function returns the handle of the Contact database, the database that contains all of the &quot;address book&quot; data used by the <STRONG CLASS="fileName">
contdb</STRONG>
 library. This handle is necessary for various operations with the library. When you're done with the handle, remember to call <CODE>
<A HREF="../../CRef/Routines/R_f.htm#IX_ContactReleaseDBHandle()">ContactReleaseDBHandle()</A></CODE>
.</P>
<P CLASS="refField"><STRONG>
Include:</STRONG>	<STRONG CLASS="fileName">
contdb.goh</STRONG>
 </P>
<P CLASS="refField"><STRONG>
See Also:</STRONG> <CODE><A HREF="../../CRef/Routines/R_e.htm#IX_ContactGetDBHandleNoBlock()">ContactGetDBHandleNoBlock()</A></CODE>,
<CODE><A HREF="../../CRef/Routines/R_f.htm#IX_ContactReleaseDBHandle()">ContactReleaseDBHandle()</A></CODE>.</P>
</DIV>
<DIV>
<A NAME="IX_ContactGetDBHandleNoBlock()">
 </A>
<H1 CLASS="refHeading">
ContactGetDBHandleNoBlock()</H1>
<PRE CLASS="syntax">VMFileHandle 	ContactGetDBHandleNoBlock( void );</PRE>
<P>
This function behaves in the same manner as <CODE>
<A HREF="../../CRef/Routines/R_e.htm#IX_ContactGetDBHandle()">ContactGetDBHandle()</A></CODE>
, except that if it cannot get the handle, it returns zero instead of waiting until the handleis available.When you're done with the handle, remember to call <CODE>
<A HREF="../../CRef/Routines/R_f.htm#IX_ContactReleaseDBHandle()">ContactReleaseDBHandle()</A></CODE>
.</P>
<P CLASS="refField"><STRONG>
Include:</STRONG>	<STRONG CLASS="fileName">
contdb.goh</STRONG>
 </P>
<P CLASS="refField"><STRONG>
See Also:</STRONG> <CODE><A HREF="../../CRef/Routines/R_e.htm#IX_ContactGetDBHandle()">ContactGetDBHandle()</A></CODE>.</P>
</DIV>
<DIV>
<A NAME="IX_ContactGetName()">
 </A>
<H1 CLASS="refHeading">
ContactGetName()</H1>
<PRE CLASS="syntax">Boolean	ContactGetName( 
        MemHandle 		record,
        TCHAR 		*dest);</PRE>
<P>
This function gets the name associated with the record, filling in the <EM>dest</EM> buffer. If there was no name in the record, this function returns non-zero; otherwise, it returns zero.</P>
<P CLASS="refField"><STRONG>
Include:</STRONG>	<STRONG CLASS="fileName">
contdb.goh</STRONG>
 </P>
<P CLASS="refField"><STRONG>
See Also:</STRONG> <CODE><A HREF="../../CRef/Routines/R_e.htm#IX_ContactGetDBHandle()">ContactGetDBHandle()</A></CODE>.</P>
</DIV>
<DIV>
<A NAME="IX_ContactGetTruncatedName()">
 </A>
<H1 CLASS="refHeading">
ContactGetTruncatedName()</H1>
<PRE CLASS="syntax">Boolean	ContactGetTrunactedName( 
        MemHandle 		record,
        TCHAR 		*dest,
        word		destSize);				/* Size of dest buffer */</PRE>
<P>
This function gets the name associated with the record, filling in the <EM>dest</EM> buffer. It will truncate the name, as necessary to make it fit inside the buffer. Remember to leave space for the null terminator when determining how big a buffer you'll need. If there was no name in the record, this function returns non-zero; otherwise, it returns zero.</P>
<P CLASS="refField"><STRONG>
Include:</STRONG>	<STRONG CLASS="fileName">
contdb.goh</STRONG>
 </P>
<P CLASS="refField"><STRONG>
See Also:</STRONG> <CODE><A HREF="../../CRef/Routines/R_e.htm#IX_ContactGetDBHandle()">ContactGetDBHandle()</A></CODE>.</P>
</DIV>
<DIV>
<A NAME="IX_ContactGetUserDataID()">
 </A>
<H1 CLASS="refHeading">
ContactGetUserDataID()</H1>
<PRE CLASS="syntax">RecordID	ContactGetUserDataID( void );</PRE>
<P>
This functionreturns the <CODE>
RecordID </CODE>
of the special Contacts database record containing the user's own contact data.</P>
<P CLASS="refField"><STRONG>
Include:</STRONG>	<STRONG CLASS="fileName">
contdb.goh</STRONG>
 </P>
<P CLASS="refField"><STRONG>
See Also:</STRONG> <CODE>FoamDBGetRecordFromID()</CODE>.</P>
</DIV>
<DIV>
<A NAME="IX_ContactImportDBFromTextFile()">
 </A>
<H1 CLASS="refHeading">
ContactImportDBFromTextFile()</H1>
<PRE CLASS="syntax">void 	ContactImportDBFromTextFile(
        hptr 		fileImport);					/* file's handle */</PRE>
<P>
This function imports contact database information from an ASCII text file. This file's format is described below. The function will compare imported records to those already in the Contacts database. Any identical records will be merged.</P>
<P>
A short sample file is shown below. </P>
<PRE>[RECORD]
[FIELD]
Name
[FIELD-NAME]
[FIELD-DATA]
Hudson W.
[FIELD-END]
[FIELD]</PRE>
<PRE>Company
[FIELD-NAME]
[FIELD-DATA]
Space Marines
[FIELD-END]
[FIELD]
Title
[FIELD-NAME]
[FIELD-DATA]
Private
[FIELD-END]
[RECORD-END]</PRE>
<PRE>[RECORD]
[FIELD]
Name
[FIELD-NAME]
[FIELD-DATA]</PRE>
<PRE>Adams, John Quincy
[FIELD-END]
[FIELD]
Tel
[FIELD-NAME]
[FIELD-DATA]
1 617 438 1776
[FIELD-END]
[FIELD]
[FIELD-NAME]
Company
[FIELD-DATA]
[FIELD-END]
USA Government
[FIELD]
Notes
[FIELD-NAME]
Note(Birthday)
[FIELD-DATA]
July 11, 1767
Gift ideas: flowers
[FIELD-END]
[RECORD-END]</PRE>
<P>
The ASCII file follows these rules:</P>
<UL>
<LI>
The page is a DOS text file, using the &quot;Latin 1&quot; code page (number 819).</LI>
<LI>
Each line of text may ends with a newline; the newline may be preceded by an optional carriage return.</LI>
<LI>
The data corresponding to each record is delimited by a line reading [RECORD] at the start and another line reading [RECORD-END] at the end. Any text that appears outside of these delimiters is lost.</LI>
<LI>
Each record consists of one or more fields. Each field is delimited by a line reading [FIELD] and a line reading [FIELD-END].</LI>
<LI>
For each field, the first line after the [FIELD] line will consist of one of the following strings, specifying the field's type:<BR>
Name, Company, Title, Address, Tel, Fax, Mail, DTMF, Note.</LI>
<LI>
There may be a line of text between the [FIELD-NAME] and [FIELD-DATA] lines. If there is no such line of text, then the field's name is the default name for its data type. If there is such a line of text, then you may form the field name by placing the text of this line between parentheses and preceding it with the default name for the field. In the &quot;Birthday&quot; example, above, the full field name would be &quot;Note(Birthday)&quot;.<BR>
The <EM>
exception</EM>
 to this rule is &quot;GSM/PCN&quot; in phone number fields. If the line of text is &quot;GSM/PCN&quot;, treat it as if it were &quot;GSM&quot;. The full field name will probably be &quot;Tel(GSM)&quot; or &quot;Fax(GSM)&quot;.</LI>
<LI>
The line(s) of text between the [FIELD-DATA] line and the [FIELD-END] line contain the field's data, if any. If there are no lines of text, that means that the field contains no data. There may be more than one line of text.</LI>
</UL>
<P CLASS="refField"><STRONG>
Include:</STRONG>	<STRONG CLASS="fileName">
contdb.goh</STRONG>
 </P>
<P CLASS="refField"><STRONG>
See Also:</STRONG> <CODE><A HREF="../../CRef/Routines/R_d.htm#IX_ContactExportDBToTextFile()">ContactExportDBToTextFile()</A></CODE>.</P>
</DIV>
<DIV>
<A NAME="IX_ContactMatchName()">
 </A>
<H1 CLASS="refHeading">
ContactMatchName()</H1>
<PRE CLASS="syntax">RecordID	ContactMatchName( 
        TCHAR		name,
        ContdbFieldType		type,
        Boolean		stopEarly,
        FieldID		*field,
        word		*numMatches );</PRE>
<P>
This function takes aname, searches all fields of the specified type in all records of the Contact database, returning the <CODE>
RecordID</CODE>
 and <CODE>
FieldID</CODE>
 of the matching field, if any; if there was no match, it returns -1.</P>
<P>
The comparison of names does not consider case.</P>
<P>
This function takes the following arguments:</P>
<DL>
<DT>
<EM>name</EM></DT><DD>String containing the name to match. </DD>
<DT>
<EM>type</EM></DT><DD>The type of phone number to match; one of CFT_NAME, CFT_COMPANY CFT_TITLE, CFT_ADDRESS, CFT_PHONE, CFT_FAX, CFT_EMAIL, CFT_DTMF, CFT_NOTES. </DD>
<DT>
<EM>stopEarly</EM></DT><DD>Set this flag <EM>
true</EM>
 to stop searching after finding the first matching name; set it <EM>
false</EM>
 to find out the number of matching names.</DD>
<DT>
<EM>field</EM></DT><DD>Pointer to a <CODE>
FieldID</CODE>
 buffer. The function will fill this buffer in with the <CODE>
FieldID</CODE>
 of the matching field, if any.</DD>
<DT>
<EM>numMatches</DT><DD>
</EM>Pointer to a word buffer. The function will fill this buffer in with the number of matching records found. This number is only meaningful if the stopEarly flag is <EM>
false</EM>
.</DD>
</DL>
<P CLASS="refField"><STRONG>
Include:</STRONG>	<STRONG CLASS="fileName">
contdb.goh</STRONG>
 </P>
<P CLASS="refField"><STRONG>
See Also:</STRONG> <CODE><A HREF="../../CRef/Routines/R_d.htm#IX_ContactEnsureEmptyField()">ContactEnsureEmptyField()</A></CODE>,
<CODE>FoamDBSetFieldData()</CODE>.</P>
</DIV>
<HR>
<!-- This blob is a bunch of standard links: up, back, index, etc. -->
<!-- up to top -->|&nbsp;<A HREF="../../index.htm"><IMG SRC="../../docImages/upTop.gif" ALT="Up: " BORDER="0">GEOS SDK TechDocs</A>
<!-- up to parent -->| <A HREF="index.htm"><IMG SRC="../../docImages/up.gif" ALT="Up" BORDER="0"></A>
<!-- down to first child --> 
<!-- to previous --> | <A HREF="R_d.htm"><IMG SRC="../../docImages/prev.gif" BORDER="0" ALT="Prev: ">ConstructOptr() ...</A> 
<!-- to next --> | <A HREF="R_f.htm"><IMG SRC="../../docImages/next.gif" BORDER="0" ALT="Next: ">ContactMatchNumber() ...</A> 
<HR>
<!-- That blob was a bunch of standard links: up, back, index, etc. -->
</BODY>
</HTML>
