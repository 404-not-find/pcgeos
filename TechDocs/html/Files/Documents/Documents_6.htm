<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>

<!-- $Id: Documents_6.htm,v 1.1 97/06/02 14:43:35 lawrence Exp $ -->
<META NAME="copyright" CONTENT="Copyright 1997 GEOWORKS">
<!-- <META NAME="description" CONTENT=""> -->
<!-- <META NAME="keywords" CONTENT=""> -->
<LINK REL="STYLESHEET" HREF="../../docHelpers/style.css">
<LINK REV="MADE" HREF="mailto:doc-feedback@geoworks.com">

<TITLE> GenDocumentControl Data</TITLE></HEAD>
<BODY BGCOLOR="#ffffff">


<H1 CLASS="subsectionTitle">
<A HREF="index.htm">Documents</A>: 2.1 <A HREF="Documents_5.htm">Document Control Data Fields</A>: 
GenDocumentControl Data</H1>
<!-- This blob is a bunch of standard links: up, back, index, etc. -->
<!-- up to top -->|&nbsp;<A HREF="../../index.htm"><IMG SRC="../../docImages/upTop.gif" ALT="Up: " BORDER="0">GEOS SDK TechDocs</A>
<!-- up to parent -->| <A HREF="Documents_5.htm"><IMG SRC="../../docImages/up.gif" ALT="Up" BORDER="0"></A>
<!-- down to first child --> 
<!-- to previous --> | <A HREF="Documents_5.htm"><IMG SRC="../../docImages/prevUp.gif" BORDER="0" ALT="Prev: ">2 Document Control Data Fields</A> 
<!-- to next --> | <A HREF="Documents_7.htm"><IMG SRC="../../docImages/next.gif" BORDER="0" ALT="Next: ">2.2 GenDocumentGroup Data</A> 
<HR>
<!-- That blob was a bunch of standard links: up, back, index, etc. -->
<P>
<A NAME="IX_GenDocumentControlClass">
 </A>
The GenDocumentControl handles interaction between the document control and the user. It maintains the File menu entries and manages the file selector. Its attributes all relate to these duties. A complete list of the attributes follows in <A HREF="Documents_6.htm#91137"> GenDocumentControl Instance Data</A>
 along with comments and the default values.</P>
<P>
Some of these data fields can be examined but not set by the application. Data fields for purely internal use (which are neither examined, nor set, by applications) are not listed.</P>
<P CLASS="figTitle">
Code Display 13-1 <A NAME="91137">
 </A>
GenDocumentControl Instance Data</P>
<PRE>/* The GDCI_documentToken field specifies the token characters and token ID of
 * files managed by this document control. All files created by the document
 * control will have these token characters, and the File Selector object will be
 * set to allow only such files to be selected. This attribute is ignored if DOS
 * files are being opened. */
    @instance GeodeToken			GDCI_documentToken = {};</PRE>
<PRE>/* GDCI_selectorType determines which files will be displayed by the File Selector 
 * generated by this object. Only one of the options may be set. By default, only
 * documents are visible. */
    @instance GenFileSelectorType				GDCI_selectorType = GFST_DOCUMENTS;
	/* Types available: 
	 *	GFST_DOCUMENTS, 			GFST_EXECUTABLES, 
	 * 	GFST_NON_GEOS_FILES, 			GFST_ALL_FILES */</PRE>
<PRE>/* GDCI_attrs specifies certain characteristics of the file to be opened. The
 * default setting is shown below. */
    @instance GenDocumentControlAttrs					GDCI_attrs = 
			((GDCM_SHARED_SINGLE &lt;&lt; GDCA_MODE_OFFSET) |
			 GDCA_VM_FILE | 
			 GDCA_SUPPORTS_SAVE_AS_REVERT |
			 (GDCT_NEW &lt;&lt; GDCA_CURRENT_TASK_OFFSET))
	/* Attributes available:
	 * GDCA_MODE: 
	 *	GDCM_VIEWER, 			GDCM_SHARED_SINGLE,
	 *	GDCM_SHARED_MULTIPLE
	 * GDCA_CURRENT_TASK: 
	 * 	GDCT_NONE, 			GDCT_NEW, 
	 * 	GDCT_OPEN, 			GDCT_USE_TEMPLATE, 
	 *	GDCT_SAVE_AS,			GDCT_COPY_TO,
	 *	GDCT_DIALOG,			GDCT_TYPE,
	 *	GDCT_PASSWORD
	 * Other fields: 
	 * 	GDCA_MULTIPLE_OPEN_FILES,				GDCA_DOS_FILE_DENY_WRITE,
	 *	GDCA_VM_FILE, 				GDCA_NATIVE,
	 * 	GDCA_SUPPORTS_SAVE_AS_REVERT,				GDCA_DOCUMENT_EXISTS,
	 *	GDCA_DO_NOT_SAVE_FILES
	 */</PRE>
<PRE>/* GDCI_features specifies certain extra features of the document control. The
 * default setting is shown below. */
    @instance GenDocumentControlFeatures					GDCI_features = 
			(GDCF_READ_ONLY_SUPPORTS_SAVE_AS_REVERT |
			 GDCF_SINGLE_FILE_CLEAN_CAN_NEW_OPEN |
			 GDCF_SUPPORTS_TEMPLATES |
			 GDCF_SUPPORTS_USER_SETTABLE_EMPTY_DOCUMENT |
			 GDCF_SUPPORTS_USER_MAKING_SHARED_DOCUMENTS |
			 GDCF_NAME_ON_PRIMARY);
	/* Flags available: 
	 *	GDCF_READ_ONLY_SUPPORTS_SAVE_AS_REVERT,
	 *	GDCF_SINGLE_FILE_CLEAN_CAN_NEW_OPEN, 
	 * 	GDCF_SUPPORTS_TEMPLATES,
	 *	GDCF_SUPPORTS_USER_SETTABLE_EMPTY_DOCUMENT,
	 *	GDCF_SUPPORTS_USER_SETTABLE_DEFAULT_DOCUMENT,
	 *	GDCF_SUPPORTS_USER_MAKING_SHARED_DOCUMENTS,
	 *	GDCF_NAME_ON_PRIMARY */</PRE>
<PRE>/* GDCI_enableDisableList specifies objects which should be enabled whenever a
 * document is opened and disabled when all documents are closed. The field is the
 * handle of a chunk containing a list of optrs to the objects to be enabled and
 * disabled. The default value is a null handle.*/
    @instance ChunkHandle			 	GDCI_enableDisableList;</PRE>
<PRE>/* The GDCI_openGroup, GDCI_importGroup, GDCI_useTemplateGroup, GDCI_saveAsGroup,
 * GDCI_exportGroup, and GDCI_userLevelGroup attributes hold optrs to groups of UI
 * objects to be added to the &quot;Open,&quot; &quot;Import,&quot; &quot;Use Template,&quot; &quot;Save As,&quot;
 * &quot;Export,&quot; and &quot;User Level&quot;, dialog boxes, respectively. The GDCI_dialogGroup
 * field holds an optr to objects to be added to the opening dialog box. The optr
 * is to the head of a tree of UI objects. The top object in the tree should be
 * set &quot;not usable.&quot; Default values are all null optrs. */
    @instance optr				GDCI_openGroup;
    @instance optr				GDCI_importGroup;
    @instance optr				GDCI_useTemplateGroup;
    @instance optr				GDCI_saveAsGroup;
    @instance optr				GDCI_exportGroup;
    @instance optr				GDCI_dialogGroup;
    @instance optr				GDCI_userLevelGroup;</PRE>
<PRE>/* If the GDCI_features field includes &quot;displayNameOnPrimary&quot; but no document is
 * open, the Primary's moniker is set to the string pointed to by the
 * GDCI_noNameText attribute. The default value is a null chunk handle. */
    @instance ChunkHandle				GDCI_noNameText;</PRE>
<PRE>/* If the GDCA_currentTask section of the GDCI_attrs field is set to
 * GDCT_NONE on startup, then the file specified by GDCI_defaultFile will be
 * opened (and, if necessary, created). The file is specified by a chunk handle of
 * a null-terminated string; this string should specify the file's path relative
 * to the SP_DOCUMENT standard path.The default value is a null chunk handle,
 * indicating that if the startup value of GDCA_currentTask is GDCT_NONE, no
 * documents should be opened. */
    @instance ChunkHandle 				GDCI_defaultFile;</PRE>
<PRE>/* GDCI_templateDir is the chunk handle of a null-terminated text string which
 * specifies a directory to hold template documents. The directory is specified
 * relative to SP_TEMPLATE. If not set by you, this defaults to the SP_TEMPLATE
 * standard path. */
    @instance ChunkHandle				GDCI_templateDir;</PRE>
<PRE>/* GDCI_documentGroup is an optr to the GenDocumentGroup object. You must set
 * this field. */
    @instance optr			GDCI_documentGroup;</PRE>
<PRE>/* GDCI_targetDocName is a character array. It is set to contain the name of
 * the current target file. This field is automatically updated by the document
 * control. */
    @instance FileLongName				GDCI_targetDocName = &quot;&quot;;</PRE>
<PRE>/* The Document Control automatically displays a big dialog box at startup which
 * lets the user choose to create, open, etc. a file. Each option has a button
 * (with a picture) and an explanatory text. You can override the default graphic
 * or text by setting any of the following fields:
 */</PRE>
<PRE>    @instance ChunkHandle				GDCI_dialogNewText;
    @instance ChunkHandle				GDCI_dialogTemplateText;
    @instance ChunkHandle				GDCI_dialogOpenDefaultText
    @instance ChunkHandle				GDCI_dialogImportText;
    @instance ChunkHandle				GDCI_dialogOpenText;
    @instance ChunkHandle				GDCI_dialogUserLevelText;</PRE>
<PRE>    @instance @visMoniker				GDCI_dialogNewMoniker;
    @instance @visMoniker				GDCI_dialogTemplateMoniker;
    @instance @visMoniker				GDCI_dialogOpenDefaultMoniker
    @instance @visMoniker				GDCI_dialogImportMoniker;
    @instance @visMoniker				GDCI_dialogOpenMoniker;
    @instance @visMoniker				GDCI_dialogUserLevelMoniker;</PRE>
<PRE>&nbsp;</PRE>

<H2 CLASS="HeadingC">
The Document Token</H2>
<PRE>GDCI_documentToken, MSG_GEN_DOCUMENT_CONTROL_GET_TOKEN, MSG_GEN_DOCUMENT_GROUP_GET_TOKEN</PRE>
<P>
<A NAME="IX_GDCI_documentToken">
 </A>
The document control's file selector will display only those files whose document token matches the GenDocumentControl object's <CODE>
GDCI_documentToken</CODE>
 attribute. All files created by the application will have the specified document tokens. There are no messages to alter the token attributes at run-time. (If the document control is used to manage DOS files, the file selector will show all non-GEOS files.)</P>
<P>
A token is defined by a<CODE>
 GeodeToken</CODE>
 structure. The format of this structure is shown below. The first field, <CODE>
GT_chars</CODE>
, will vary for each document type. The second, <CODE>
GT_manufID</CODE>
, will be the same for the tokens of all applications and documents created by a given company.</P>
<PRE>typedef struct {
	char 		GT_chars[TOKEN_CHARS_LENGTH]; 
				/* TOKEN_CHARS_LENGTH = 4 */
	ManufacturerID 		GT_manufID;
				/* word-sized integer */
} GeodeToken;</PRE>
<P>
The message <CODE>
MSG_GEN_DOCUMENT_CONTROL_GET_TOKEN</CODE>
 instructs the GenDocumentControl object to write a copy of the document token to a specified address. The message has one argument: the address of a<CODE>
 </CODE>
<CODE>
GeodeToken</CODE>
. <CODE>
MSG_GEN_DOCUMENT_GROUP_GET_TOKEN</CODE>
 functions identically, but it is sent to the GenDocumentGroup object.</P>
<P>
You can also find out the application's token by sending GEN_DOCUMENT_CONTROL_GET_CREATOR or GEN_DOCUMENT_GROUP_GET_CREATOR to the appropriate object. The application's token will be used as the &quot;creator token&quot; for any documents created by the document control.</P>

<H4 CLASS="RefETitle">
<A NAME="IX_MSG_GEN_DOCUMENT_CONTROL_GET_TOKEN">
 </A>
MSG_GEN_DOCUMENT_CONTROL_GET_TOKEN</H4>
<PRE CLASS="syntax">void 	MSG_GEN_DOCUMENT_CONTROL_GET_TOKEN(
        GeodeToken *		token); /* address to copy token to */</PRE>
<P>
This message gets the document token values for all documents created by this document control.</P>
<P CLASS="refField">
Source:	Unrestricted.</P>
<P CLASS="refField">
Destination:	<CODE>
Any GenDocumentControl object.</CODE>
</P>
<P CLASS="refField">
Parameters:	<EM>
token</EM>
	A pointer to an empty <CODE>
GeodeToken</CODE>
 structure.</P>
<P CLASS="refField">
Return:	The document <CODE>
GeodeToken</CODE>
 is written to the variable whose address is passed.</P>
<P CLASS="refField">
Interception:	You should not subclass this message.</P>


<H4 CLASS="RefETitle">
<A NAME="IX_MSG_GEN_DOCUMENT_GROUP_GET_TOKEN">
 </A>
MSG_GEN_DOCUMENT_GROUP_GET_TOKEN</H4>
<PRE CLASS="syntax">void 	MSG_GEN_DOCUMENT_GROUP_GET_TOKEN(
        GeodeToken *		token); /* address to copy token to */</PRE>
<P>
This is the same as <CODE>
MSG_GEN_DOCUMENT_CONTROL_GET_TOKEN</CODE>
, except that it is sent to the GenDocumentGroup object instead of the GenDocumentControl object.</P>
<P CLASS="refField">
Source:	Unrestricted.</P>
<P CLASS="refField">
Destination:	<CODE>
Any GenDocumentGroup object.</CODE>
</P>
<P CLASS="refField">
Parameters:	<EM>
token</EM>
	A pointer to an empty <CODE>
GeodeToken</CODE>
 structure.</P>
<P CLASS="refField">
Return:	The document <CODE>
GeodeToken</CODE>
 is written to the variable whose address is passed.</P>
<P CLASS="refField">
Interception:	You should not subclass this message.</P>


<H4 CLASS="RefETitle">
<A NAME="IX_MSG_GEN_DOCUMENT_CONTROL_GET_TOKEN">
 </A>
MSG_GEN_DOCUMENT_CONTROL_GET_CREATOR</H4>
<PRE CLASS="syntax">void 	MSG_GEN_DOCUMENT_CONTROL_GET_CREATOR(
        GeodeToken *		token); /* address to copy token to */</PRE>
<P>
This message gets the token for the application; this token is the &quot;creator token&quot; for all files created by the document control.</P>
<P CLASS="refField">
Source:	Unrestricted.</P>
<P CLASS="refField">
Destination:	<CODE>
Any GenDocumentControl object.</CODE>
</P>
<P CLASS="refField">
Parameters:	<EM>
token</EM>
	A pointer to an empty <CODE>
GeodeToken</CODE>
 structure.</P>
<P CLASS="refField">
Return:	The document <CODE>
GeodeToken</CODE>
 is written to the variable whose address is passed.</P>
<P CLASS="refField">
Interception:	You should not subclass this message.</P>


<H4 CLASS="RefETitle">
<A NAME="IX_MSG_GEN_DOCUMENT_GROUP_GET_TOKEN">
 </A>
MSG_GEN_DOCUMENT_GROUP_GET_CREATOR</H4>
<PRE CLASS="syntax">void 	MSG_GEN_DOCUMENT_GROUP_GET_CREATOR(
        GeodeToken *		token); /* address to copy token to */</PRE>
<P>
This is the same as <CODE>
MSG_GEN_DOCUMENT_CONTROL_GET_CREATOR</CODE>
, except that it is sent to the GenDocumentGroup object instead of the GenDocumentControl object.</P>
<P CLASS="refField">
Source:	Unrestricted.</P>
<P CLASS="refField">
Destination:	<CODE>
Any GenDocumentGroup object.</CODE>
</P>
<P CLASS="refField">
Parameters:	<EM>
token</EM>
	A pointer to an empty <CODE>
GeodeToken</CODE>
 structure.</P>
<P CLASS="refField">
Return:	The document <CODE>
GeodeToken</CODE>
 is written to the variable whose address is passed.</P>
<P CLASS="refField">
Interception:	You should not subclass this message.</P>



<H2 CLASS="HeadingC">
The GDCI_selectorType Field</H2>
<PRE>GDCI_selectorType</PRE>
<P>
<A NAME="IX_GFST_&ldots;">
 </A>
<A NAME="IX_GDCI_selectorType">
 </A>
The<CODE>
 GDCI_selectorType </CODE>
field determines what files will be displayed by and can be opened with the file selector. The options are stored as a byte-sized enumerated type. The options are:</P>
<DL>
<DT>
GFST_DOCUMENTS</DT><DD>
This is the default option. The file selector will display those documents with the appropriate tokens.</DD>
<DT>
GFST_EXECUTABLES</DT><DD>
The file selector will display executable files as well as appropriate document files.</DD>
<DT>
GFST_NON_GEOS_FILES</DT><DD>
The file selector will display all non-GEOS files (and only non-GEOS files). </DD>
<DT>
GFST_ALL_FILES</DT><DD>
 The file selector will display all files.</DD>


</DL>
<H2 CLASS="HeadingC">
The GDCI_attrs Field</H2>
<PRE>GDCI_attrs, MSG_GEN_DOCUMENT_CONTROL_GET_ATTRS, MSG_GEN_DOCUMENT_GROUP_GET_UI_ATTRS</PRE>
<P>
<A NAME="IX_GDCA_&ldots;">
 </A>
<A NAME="IX_GDCI_attrs">
 </A>
The GenDocumentControl<CODE>
 </CODE>
object has eight attribute flags stored in the word-sized bitfield <CODE>
GDCI_attrs</CODE>
. They may be retrieved by sending <CODE>
MSG_GEN_DOCUMENT_CONTROL_GET_ATTRS</CODE>
 to the GenDocumentControl<EM>
 </EM>
object or by sending <CODE>
MSG_GEN_DOCUMENT_GROUP_GET_UI_ATTRS</CODE>
 to the GenDocumentGroup object. The attributes are set at coding time; there is no way for an application to change the attributes at run-time, although the GenDocumentControl will change some of the attributes to reflect its current state.</P>
<P>
The attributes are</P>
<DL>
<DT CLASS="FIXME_WorListWide">
GDCA_MULTIPLE_OPEN_FILES</DT><DD>
Allow several documents to be open at once. If this attribute is disabled, the &quot;New&quot; and &quot;Open&quot; triggers will be disabled when a document is open (however, see also the description of the flag GDCF_SINGLE_FILE_CLEAN_CAN_NEW_OPEN on <A HREF="Documents_6.htm#91918"> GDCF_SINGLE_FILE_CLEAN_CAN_NEW_OPEN This feature is ignored if the attribute GDCA_MULTIPLE_OPEN_FILES is on. If GDCF_SINGLE_FILE_CLEAN_CAN_NEW_OPEN is on and GDCA_MULTIPLE_OPEN_FILES is off, the "New" and "Open" triggers are enabled when the doc</A>
). This attribute defaults to off.</DD>
<DT CLASS="FIXME_WorListWide">
GDCA_MODE</DT><DD>
This is a two-bit field. GDCA_MODE is a mask of all the bits in this field; the offset of this field is equal to the constant GDCA_MODE_OFFSET. The field has the following possible settings:</DD>
<DT>
GDCM_VIEWER</DT><DD>
<A NAME="IX_GDCM_&ldots;">
 </A>
All documents are opened in read-only mode; the New, Save, Save As, and Revert triggers are permanently disabled. Other applications can open the file for read/write access.</DD>
<DT>
GDCM_SHARED_SINGLE</DT><DD>
Documents are opened for reading and writing. When a document is open, it is marked &quot;deny-write&quot; so other applications can open the file only for read-only access. The user can mark a document as a &quot;public&quot; document, in which case the default is to open a file &quot;read-only.&quot; The default GDCA_MODE setting is GDCM_SHARED_SINGLE.</DD>
<DT>
GDCM_SHARED_MULTIPLE</DT><DD>
This mode is designed for documents that can have multiple writers, such as multi-user databases. Documents are ordinarily opened as in GDCM_SHARED_SINGLE mode above; however, a user can designate a file as a &quot;multi-user&quot; file, which means that it can be opened by several applications at once for read/write access.</DD>
<DT CLASS="FIXME_WorListWide">
</DT><DD>The default setting of the GDCA_MODE flag is GDCM_SHARED_SINGLE. If you want a different value, first clear the two-bit field, then set the new setting, like this:</DD>
<PRE>GDCI_attrs = (@default &amp; ~GDCA_MODE) \
	| (GDCM_VIEWER &lt;&lt; GDCA_MODE_OFFSET);</PRE>
<DT CLASS="FIXME_WorListWide">
</DT><DD>Note that the GDCA_MODE attribute has a slightly different effect if the document control manages DOS files. For details, see GDCA_DOS_FILE_DENY_WRITE below.</DD>
<DT CLASS="FIXME_WorListWide">
GDCA_DOS_FILE_DENY_WRITE</DT><DD>
This attribute does not matter for VM files. If a DOS file is opened while the GDCA_DOS_FILE_DENY_WRITE bit is set, no other application will be able to write to that file. This is true even if the DOS file was opened for read-only access; however, if the file is a multi-user document opened in &quot;shared-multiple&quot; mode, other applications will be able to write to it regardless of whether the GDCA_DOS_FILE_DENY_WRITE attribute is set. By default, GDCA_DOS_FILE_DENY_WRITE is off.</DD>
<DT CLASS="FIXME_WorListWide">
GDCA_VM_FILE</DT><DD>
This attribute specifies whether the document control objects will open GEOS Virtual Memory files (if GDCA_VM_FILE is on), or DOS files (if GDCA_VM_FILE is off). The default value is on.</DD>
<DT CLASS="FIXME_WorListWide">
GDCA_NATIVE</DT><DD>
If this bit is set and GDCA_VM_FILE is not set, documents will be stored in the format native to the file-system.</DD>
<DT CLASS="FIXME_WorListWide">
GDCA_SUPPORTS_SAVE_AS_REVERT</DT><DD>
This attribute is ordinarily set only for GEOS files. If the attribute is on, the application will use the backup functionality of VM files to support &quot;Save As&quot; and &quot;Revert&quot; functionality. If the attribute is off, the file will be altered whenever it is updated to disk. The default value is on. DOS files do not normally support &quot;Save As&quot; and &quot;Revert.&quot; Applications can implement &quot;Save As&quot; and &quot;Revert&quot; functionality for DOS files by defining a subclass of <CODE>
GenDocumentClass</CODE>
 with handlers for <CODE>
MSG_GEN_DOCUMENT_PHYSICAL_SAVE_AS</CODE>
 and <CODE>
MSG_GEN_DOCUMENT_PHYSICAL_REVERT</CODE>
, but this is not recommended. Ordinarily, this attribute should be off for DOS files.</DD>
<DT CLASS="FIXME_WorListWide">
GDCA_DOCUMENT_EXISTS</DT><DD>
This attribute is set and maintained at run-time by the GenDocumentControl code. The attribute is on if at least one document is open.</DD>
<DT CLASS="FIXME_WorListWide">
GDCA_CURRENT_TASK</DT><DD>
This three-bit attribute has a dual function: It determines the application's behavior at start-up, and it indicates what task the application is currently performing. The mask GDCA_CURRENT_TASK is a mask of all the bits in this field; the field's offset is equal to the constant GDCA_CURRENT_TASK_OFFSET. The possible settings are as follows:</DD>
<DT>
GDCT_NONE</DT><DD>
<A NAME="IX_GDCT_&ldots;">
 </A>
If a default file has been specified (see <A HREF="Documents_6.htm#16472"> The GDCI_noNameText Field</A>
), that file will be opened; otherwise, the application will start with no file opened.</DD>
<DT>
GDCT_NEW</DT><DD>
A new document will be created at startup. If the GDCF_DIALOG_BOX_FOR_NEW flag is set, a dialog box will be presented at startup.</DD>
<DT>
GDCT_OPEN</DT><DD>
The &quot;Open File&quot; dialog box will be presented at startup.</DD>
<DT>
GDCT_USE_TEMPLATE</DT><DD>
The &quot;Use Template&quot; dialog box will be presented at startup.</DD>
<DT>
GDCT_SAVE_AS</DT><DD>
This is not a valid initial setting. The GDCA_CURRENT_TASK field has this setting between when a user chooses the &quot;Save As&quot; command and when the document is saved.</DD>
<DT>
GDCT_COPY_TO</DT><DD>
This is not a valid initial setting. The GDCA_CURRENT_TASK field has this setting between when the user chooses the &quot;Copy To&quot; command and when the command has been fully executed.</DD>
<DT>
GDCT_DIALOG </DT>
<DT>
GDCT_TYPE </DT>
<DT>
GDCT_PASSWORD</DT><DD>
None of these are valid initial settings.</DD>
</DL>
<P>
If a document is passed in to be opened at startup (as, for example, when a user launches an application by double-clicking a file created by the application), that file will be opened, and the initial setting of GDCA_CURRENT_TASK will be ignored. The document control automatically maintains this bitfield to correspond to whatever action the document control is currently taking. The application can find out what the document control is doing by reading the attributes and checking this field.</P>
<DL>
<DT CLASS="FIXME_WorListWide">
GDCA_DO_NOT_SAVE_FILES</DT><DD>
If this bit is set, the application will not be able to save files. By setting this bit, you can turn your application into a fully-functioning demo.</DD>
<DT CLASS="FIXME_WorListWide">
GDCA_FORCE_DEMAND_PAGING</DT><DD>
If this bit is set, the document will be paged with demand-paging, even if the system ordinarily forces all documents completely into memory.</DD>

</DL>
<H4 CLASS="RefETitle">
<A NAME="IX_MSG_GEN_DOCUMENT_CONTROL_GET_ATTRS">
 </A>
MSG_GEN_DOCUMENT_CONTROL_GET_ATTRS</H4>
<PRE CLASS="syntax">GenDocumentControlAttrs 	MSG_GEN_DOCUMENT_CONTROL_GET_ATTRS();</PRE>
<P>
Use this message to find out what the GenDocumentControl object's <CODE>
GDCA_attrs</CODE>
 flags are. The attributes cannot be changed by a message; they can only be read.</P>
<P CLASS="refField">
Source:	Unrestricted.</P>
<P CLASS="refField">
Destination:	<CODE>
Any GenDocumentControl object.</CODE>
</P>
<P CLASS="refField">
Parameters:	None.</P>
<P CLASS="refField">
Return:	Returns a word-length bitfield containing GDCA<CODE>
_attrs</CODE>
 record.</P>
<P CLASS="refField">
Interception:	You should not subclass this message.</P>


<H4 CLASS="RefETitle">
<A NAME="IX_MSG_GEN_DOCUMENT_GROUP_GET_UI_ATTRS">
 </A>
MSG_GEN_DOCUMENT_GROUP_GET_UI_ATTRS</H4>
<PRE CLASS="syntax">GenDocumentControlAttrs 	MSG_GEN_DOCUMENT_GROUP_GET_UI_ATTRS();</PRE>
<P>
This message is the same as the <CODE>
MSG_GEN_DOCUMENT_CONTROL_GET_ATTRS</CODE>
 message (see above) except that it is sent to the GenDocumentGroup object.</P>
<P CLASS="refField">
Source:	Unrestricted.</P>
<P CLASS="refField">
Destination:	<CODE>
Any GenDocumentGroup object.</CODE>
</P>
<P CLASS="refField">
Parameters:	None.</P>
<P CLASS="refField">
Return:	A word-length record containing the GDCA<CODE>
_attrs</CODE>
 field.</P>
<P CLASS="refField">
Interception:	You should not subclass this message.</P>



<H2 CLASS="HeadingC">
The GDCI_features Flags</H2>
<PRE>GDCI_features, MSG_GEN_DOCUMENT_CONTROL_GET_FEATURES, MSG_GEN_DOCUMENT_GROUP_GET_UI_FEATURES, MSG_GEN_CONTROL_CONFIGURE_FILE_SELECTOR</PRE>
<P>
<A NAME="IX_GDCI_features">
 </A>
The <CODE>
GDCI_features</CODE>
 attribute specifies whether certain optional functionality of the Document Control technology is enabled. The features are determined at coding time; there is no message to change features at run-time. To retrieve the features, send <CODE>
MSG_GEN_DOCUMENT_CONTROL_GET_FEATURES</CODE>
.</P>
<DL>
<DT CLASS="FIXME_WorListWide">
GDCF_READ_ONLY_SUPPORTS_SAVE_AS_REVERT</DT><DD>
<A NAME="IX_GenDocumentControlFeatures">
 </A>
<A NAME="IX_GDCF_&ldots;  (GenDocumentControlFeatures)">
 </A>
If this feature is on, the &quot;Save As&quot; and &quot;Revert&quot; triggers are enabled when read-only documents are opened. Once the user chooses &quot;Save As,&quot; the new file will no longer be opened as &quot;Read Only&quot;; the &quot;Save&quot; trigger will be enabled. If this feature is off, &quot;Save As&quot; and &quot;Revert&quot; triggers are disabled for read-only files. By default, this feature is on.</DD>
<DT CLASS="FIXME_WorListWide">
GDCF_SINGLE_FILE_CLEAN_CAN_NEW_OPEN</DT><DD>
<A NAME="91918">
 </A>
This feature is ignored if the attribute<CODE>
 </CODE>
GDCA_MULTIPLE_OPEN_FILES<CODE>
 </CODE>
is on. If GDCF_SINGLE_FILE_CLEAN_CAN_NEW_OPEN is on and GDCA_MULTIPLE_OPEN_FILES is off, the &quot;New&quot; and &quot;Open&quot; triggers are enabled when the document is &quot;clean&quot; (i.e., the document has not been marked &quot;dirty&quot; since it was opened/created or saved); that is, &quot;New&quot; and &quot;Open&quot; are enabled whenever &quot;Save&quot; is disabled. If the user chooses &quot;New&quot; or &quot;Open&quot; when the document is &quot;clean,&quot; the target document is closed and the new document is opened or created. If both GDCA_MULTIPLE_OPEN_FILES and GDCF_SINGLE_FILE_CLEAN_CAN_NEW_OPEN are off, the &quot;New&quot; and &quot;Open&quot; triggers are disabled whenever a document is open. By default, this attribute is on.</DD>
<DT CLASS="FIXME_WorListWide">
GDCF_SUPPORTS_TEMPLATES</DT><DD>
If this feature is enabled, the user can save files as templates. If the user chooses the command &quot;Use Template,&quot; a copy of the template is opened as a &quot;new&quot; document, and the template is left unchanged. If this feature is disabled, the application cannot create templates. By default, this feature is on.</DD>
<DT CLASS="FIXME_WorListWide">
GDCF_SUPPORTS_USER_SETTABLE_EMPTY_DOCUMENT</DT><DD>
If this feature is enabled, the user can designate a file to be the model for all new documents. When the user chooses &quot;New,&quot; this &quot;model&quot; document will be copied and the copy will be opened. By default, this feature is on. </DD>
<DT CLASS="FIXME_WorListWide">
 GDCF_SUPPORTS_USER_SETTABLE_DEFAULT_DOCUMENT</DT><DD>
If this attribute is on, the user can choose a default document (one which will automatically be opened when the application is launched). (See <A HREF="Documents_6.htm#49052"> The GDCI_defaultFile Field</A>
.)</DD>
<DT CLASS="FIXME_WorListWide">
GDCF_SUPPORTS_USER_MAKING_SHARED_DOCUMENTS</DT><DD>
If this attribute is on, the user can save a document as &quot;shared,&quot; allowing several processes to access it at once. By default, the attribute is on.</DD>
<DT CLASS="FIXME_WorListWide">
GDCF_NAME_ON_PRIMARY</DT><DD>
If this attribute is on, the name of the target document is displayed at the top of the Primary window. The GenDocumentControl object does this by changing the moniker of the GenPrimary object to the name of the target document. If there is no open document, the GenPrimary will display the string specified by the attribute <CODE>
GDCI_noNameText</CODE>
. By default, this attribute is on.</DD>
</DL>
<P>
For an added degree of control, you can use <CODE>
MSG_GEN_DOCUMENT_CONTROL_CONFIGURE_FILE_SELECTOR</CODE>
 to change the attributes of the document control's file selector.</P>

<H4 CLASS="RefETitle">
<A NAME="IX_MSG_GEN_DOCUMENT_CONTROL_GET_FEATURES">
 </A>
MSG_GEN_DOCUMENT_CONTROL_GET_FEATURES</H4>
<PRE CLASS="syntax">GenDocumentControlFeatures 	MSG_GEN_DOCUMENT_CONTROL_GET_FEATURES();</PRE>
<P>
Use this message to retrieve the current <CODE>
GDCI_features</CODE>
 flags. The flags cannot be changed at run-time.</P>
<P CLASS="refField">
Source:	Unrestricted.</P>
<P CLASS="refField">
Destination:	<CODE>
Any GenDocumentControl object.</CODE>
</P>
<P CLASS="refField">
Parameters:	None.</P>
<P CLASS="refField">
Return:	The GenDocumentControl's <CODE>
GDCI_features</CODE>
 flags.</P>
<P CLASS="refField">
Interception:	You should not subclass this message.</P>


<H4 CLASS="RefETitle">
<A NAME="IX_MSG_GEN_DOCUMENT_GROUP_GET_UI_FEATURES">
 </A>
MSG_GEN_DOCUMENT_GROUP_GET_UI_FEATURES</H4>
<PRE CLASS="syntax">GenDocumentControlFeatures 	MSG_GEN_DOCUMENT_GROUP_GET_UI_FEATURES();</PRE>
<P>
Use this message to retrieve the current <CODE>
GDCI_features</CODE>
 flags. The flags cannot be changed at run-time.</P>
<P CLASS="refField">
Source:	Unrestricted.</P>
<P CLASS="refField">
Destination:	<CODE>
Any GenDocumentGroup object.</CODE>
</P>
<P CLASS="refField">
Parameters:	None.</P>
<P CLASS="refField">
Return:	The GenDocumentControl's <CODE>
GDCI_features</CODE>
 flags.</P>
<P CLASS="refField">
Interception:	You should not subclass this message.</P>


<H4 CLASS="RefETitle">
MSG_GEN_DOCUMENT_CONTROL_CONFIGURE_FILE_SELECTOR</H4>
<PRE CLASS="syntax">void 	MSG_GEN_DOCUMENT_CONTROL_CONFIGURE_FILE_SELECTOR(
        optr 		fileSelector, 
        word 		flags); /* GenDocumentControlAttrs */</PRE>
<P>
Configure file selector. This message can be sub-classed to modify the behavior of the file selectors that the document control uses.</P>



<H2 CLASS="HeadingC">
<A NAME="29317">
 </A>
The GDCI_enableDisableList Field</H2>
<PRE>GDCI_enableDisableList</PRE>
<P>
<A NAME="IX_GDCI_enableDisableList">
 </A>
The GenDocumentControl can be set to enable certain UI objects when documents are open. This is done using the <CODE>
GDCI_enableDisableList</CODE>
 attribute. This attribute is the chunk handle of a list of object-pointers. Each of the referenced objects should start as disabled. Whenever a document is opened, a <CODE>
MSG_GEN_SET_ENABLED</CODE>
 is sent to each object in the list. When the last document is closed, a <CODE>
MSG_GEN_SET_NOT_ENABLED </CODE>
is sent to each object in the list.</P>


<H2 CLASS="HeadingC">
Adding to the Dialog Boxes</H2>
<PRE>GDCI_openGroup, GDCI_importGroup, GDCI_useTemplateGroup, GDCI_saveAsGroup, GDCI_exportGroup, GDCI_dialogGroup, GDCI_userLevelGroup</PRE>
<P>
<A NAME="IX_GDCI_saveAsGroup">
 </A>
<A NAME="IX_GDCI_useTemplateGroup">
 </A>
<A NAME="IX_GDCI_openGroup">
 </A>
The GenDocumentControl object manages the dialog boxes for many different user actions. The programmer can specify a tree of UI objects to be included with each of these dialog boxes. For example, to add a group of objects to the &quot;Use Template&quot; dialog box, the programmer should put them all in a tree (perhaps by making them all children of a<EM>
 </EM>
GenInteraction object) and store an object-pointer to the head of the tree in <A NAME="IX_GDCI_newGroup">
 </A>
the <CODE>
GDCI_useTemplateGroup</CODE>
 attribute. The top object in the tree should be set &quot;not usable.&quot;</P>


<H2 CLASS="HeadingC">
<A NAME="16472">
 </A>
The GDCI_noNameText Field</H2>
<PRE>GDCI_noNameText</PRE>
<P>
<A NAME="IX_GDCI_noNameText">
 </A>
The GenDocumentControl object can be set to display the name of the current target document in the moniker of the <CODE>
GenPrimary</CODE>
 window. If this feature is enabled, and no document is opened, the <CODE>
GenPrimary</CODE>
 will have its moniker change to the string specified by <CODE>
GDCI_noNameText</CODE>
. If the feature<CODE>
 </CODE>
GDCF_DISPLAY_NAME_ON_PRIMARY is disabled, <CODE>
GDCI_noNameText</CODE>
 is ignored.</P>


<H2 CLASS="HeadingC">
<A NAME="49052">
 </A>
The GDCI_defaultFile Field</H2>
<PRE>GDCI_defaultFile</PRE>
<P>
<A NAME="IX_GDCI_defaultFile">
 </A>
If the attribute GDCA_CURRENT_TASK is initially set to GDCT_NONE and a default file is specified, the default file is automatically opened at startup. If GDCA_CURRENT_TASK is not initially set to GDCT_NONE, this attribute is ignored. This field holds the chunk handle of a null-terminated string. The string specifies the file's path relative to the SP_DOCUMENT. If the feature<CODE>
 </CODE>
GDCF_SUPPORTS_USER_SETTABLE_DEFAULT_DOCUMENT is enabled, this attribute can be changed by the user at run-time. If the file specified does not exist, it is created as an empty document; if the document exists but cannot be opened, no file is opened at startup. If the named document exists but is inappropriate (e.g. it was created by another application), no document is opened at startup. </P>


<H2 CLASS="HeadingC">
The GDCI_templateDir Field</H2>
<PRE>GDCI_templateDir</PRE>
<P>
<A NAME="IX_GDCI_templateDir">
 </A>
If templates are supported, this is the default directory for opening and saving them. This string specifies a subdirectory to the standard path SP_TEMPLATE. If not explicitly set in the source code, the template directory will default to SP_TEMPLATE.</P>


<H2 CLASS="HeadingC">
The GDCI_documentGroup Field</H2>
<PRE>GDCI_documentGroup</PRE>
<P>
<A NAME="IX_GDCI_documentGroup">
 </A>
The GenDocumentControl and the GenDocumentGroup communicate with each other via messages. To do this, each needs the optr of the other. GDCI<CODE>
_documentGroup</CODE>
 is the optr of the <CODE>
GenDocumentGroup</CODE>
 object for this application. It is set in the source code and may not be changed at run time.</P>


<H2 CLASS="HeadingC">
The GDCI_targetDocName Field</H2>
<PRE>GDCI_targetDocName</PRE>
<P>
<A NAME="IX_GDCI_targetDocName">
 </A>
This attribute contains the name of the target document. The document control automatically sets and updates this field when necessary.</P>

<HR>
<!-- This blob is a bunch of standard links: up, back, index, etc. -->
<!-- up to top -->|&nbsp;<A HREF="../../index.htm"><IMG SRC="../../docImages/upTop.gif" ALT="Up: " BORDER="0">GEOS SDK TechDocs</A>
<!-- up to parent -->| <A HREF="Documents_5.htm"><IMG SRC="../../docImages/up.gif" ALT="Up" BORDER="0"></A>
<!-- down to first child --> 
<!-- to previous --> | <A HREF="Documents_5.htm"><IMG SRC="../../docImages/prevUp.gif" BORDER="0" ALT="Prev: ">2 Document Control Data Fields</A> 
<!-- to next --> | <A HREF="Documents_7.htm"><IMG SRC="../../docImages/next.gif" BORDER="0" ALT="Next: ">2.2 GenDocumentGroup Data</A> 
<HR>
<!-- That blob was a bunch of standard links: up, back, index, etc. -->
</BODY>
</HTML>
