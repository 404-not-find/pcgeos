<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>

<!-- $Id: Parse_a.htm,v 1.1 97/06/02 15:43:23 lawrence Exp $ -->
<META NAME="copyright" CONTENT="Copyright 1997 GEOWORKS">
<!-- <META NAME="description" CONTENT=""> -->
<!-- <META NAME="keywords" CONTENT=""> -->
<LINK REL="STYLESHEET" HREF="../../docHelpers/style.css">
<LINK REV="MADE" HREF="mailto:doc-feedback@geoworks.com">

<TITLE> Parsing a String</TITLE></HEAD>
<BODY BGCOLOR="#ffffff">


<H1 CLASS="subsectionTitle">
<A HREF="index.htm">Parse Library</A>: 3.1 <A HREF="Parse_9.htm">Coding with the Parse Library</A>: 
Parsing a String</H1>
<!-- This blob is a bunch of standard links: up, back, index, etc. -->
<!-- up to top -->|&nbsp;<A HREF="../../index.htm"><IMG SRC="../../docImages/upTop.gif" ALT="Up: " BORDER="0">GEOS SDK TechDocs</A>
<!-- up to parent -->| <A HREF="Parse_9.htm"><IMG SRC="../../docImages/up.gif" ALT="Up" BORDER="0"></A>
<!-- down to first child --> 
<!-- to previous --> | <A HREF="Parse_9.htm"><IMG SRC="../../docImages/prevUp.gif" BORDER="0" ALT="Prev: ">3 Coding with the Parse Library</A> 
<!-- to next --> | <A HREF="Parse_b.htm"><IMG SRC="../../docImages/next.gif" BORDER="0" ALT="Next: ">3.2 Evaluating a Token Sequence</A> 
<HR>
<!-- That blob was a bunch of standard links: up, back, index, etc. -->
<PRE>ParserParseString()</PRE>
<P>
<A NAME="IX_ParserParseString()">
 </A>
To parse a string, call <CODE>
ParserParseString()</CODE>
. This routine takes four arguments: </P>
<UL>
<LI>
a pointer to a null-terminated string</LI>
<LI>
a pointer to a buffer</LI>
<LI>
a pointer to a <CODE>
CParserStruct </CODE>
(This structure contains a pointer to a callback routine.)</LI>
<LI>
a <A NAME="IX_ParserReturnStruct">
 </A>
pointer to a <CODE>
CParserReturnStruct</CODE>
</LI>
</UL>
<P>
<CODE>
ParserParseString()</CODE>
 parses a string into a sequence of tokens and writes the tokens to the buffer. Whenever the parser encounters an identifier, it calls the callback routine and requests an ID number for the identifier. Similarly, when the parser encounters a function whose name it does not recognize, it calls the callback routine to get a function ID number. The ID numbers are stored in the token sequence. Note: it is best to parse strings that contain <EM>
known</EM>
 function names and identifiers.</P>
<P>
The Parser can return the following errors:</P>
<DL>
<DT>
PSEE_BAD_NUMBER</DT><DD>
The string contained a badly-formatted number.</DD>
<DT>
PSEE_BAD_CELL_REFERENCE</DT><DD>
The string contained a badly-formatted cell reference.</DD>
<DT>
PSEE_NO_CLOSE_QUOTE</DT><DD>
The string contained an opening quote with no matching closing quote.</DD>
<DT>
PSEE_COLUMN_TOO_LARGE</DT><DD>
The string contained a cell whose column index was out of bounds (greater than 255).</DD>
<DT>
PSEE_ROW_TOO_LARGE </DT><DD>
The string contained a cell whose row index was out of bounds.</DD>
<DT>
PSEE_ILLEGAL_TOKEN </DT><DD>
The string contained a character sequence which was not a legal token.</DD>
<DT>
PSEE_TOO_MANY_TOKENS</DT><DD>
The expression was too complex.</DD>
<DT>
PSEE_EXPECTED_OPEN_PAREN </DT><DD>
A function call lacked an open-parenthesis.</DD>
<DT>
PSEE_EXPECTED_CLOSE_PAREN </DT><DD>
A function call lacked a close-parenthesis.</DD>
<DT>
PSEE_BAD_EXPRESSION </DT><DD>
The string contained a badly-formed expression.</DD>
<DT>
PSEE_EXPECTED_END_OF_EXPRESSION </DT><DD>
An expression ended improperly.</DD>
<DT>
PSEE_MISSING_CLOSE_PAREN </DT><DD>
Parentheses were mismatched.</DD>
<DT>
PSEE_UNKNOWN_IDENTIFIER </DT><DD>
An identifier or external function name was encountered, and the callback routine would not provide an ID for it.</DD>
<DT>
PSEE_GENERAL</DT><DD>
General parser error.</DD>
</DL>
<HR>
<!-- This blob is a bunch of standard links: up, back, index, etc. -->
<!-- up to top -->|&nbsp;<A HREF="../../index.htm"><IMG SRC="../../docImages/upTop.gif" ALT="Up: " BORDER="0">GEOS SDK TechDocs</A>
<!-- up to parent -->| <A HREF="Parse_9.htm"><IMG SRC="../../docImages/up.gif" ALT="Up" BORDER="0"></A>
<!-- down to first child --> 
<!-- to previous --> | <A HREF="Parse_9.htm"><IMG SRC="../../docImages/prevUp.gif" BORDER="0" ALT="Prev: ">3 Coding with the Parse Library</A> 
<!-- to next --> | <A HREF="Parse_b.htm"><IMG SRC="../../docImages/next.gif" BORDER="0" ALT="Next: ">3.2 Evaluating a Token Sequence</A> 
<HR>
<!-- That blob was a bunch of standard links: up, back, index, etc. -->
</BODY>
</HTML>
