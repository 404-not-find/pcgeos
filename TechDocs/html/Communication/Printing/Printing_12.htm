<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>

<!-- $Id: Printing_12.htm,v 1.1 97/06/02 14:12:22 lawrence Exp $ -->
<META NAME="copyright" CONTENT="Copyright 1997 GEOWORKS">
<!-- <META NAME="description" CONTENT=""> -->
<!-- <META NAME="keywords" CONTENT=""> -->
<LINK REL="STYLESHEET" HREF="../../docHelpers/style.css">
<LINK REV="MADE" HREF="mailto:doc-feedback@geoworks.com">

<TITLE> Working with Instance Data</TITLE></HEAD>
<BODY BGCOLOR="#ffffff">


<H1 CLASS="subsectionTitle">
<A HREF="index.htm">The Spool Library</A>: 5.3 <A HREF="Printing_f.htm">Print Control Messages</A>: 
<A NAME="14540">
 </A>
Working with Instance Data</H1>
<!-- This blob is a bunch of standard links: up, back, index, etc. -->
<!-- up to top -->|&nbsp;<A HREF="../../index.htm"><IMG SRC="../../docImages/upTop.gif" ALT="Up: " BORDER="0">GEOS SDK TechDocs</A>
<!-- up to parent -->| <A HREF="Printing_f.htm"><IMG SRC="../../docImages/up.gif" ALT="Up" BORDER="0"></A>
<!-- down to first child --> 
<!-- to previous --> | <A HREF="Printing_11.htm"><IMG SRC="../../docImages/prev.gif" BORDER="0" ALT="Prev: ">5.2 Flow of Control Messages</A> 
<!-- to next --> | <A HREF="Printing_13.htm"><IMG SRC="../../docImages/nextUp.gif" BORDER="0" ALT="Next: ">6 Page Size Control</A> 
<HR>
<!-- That blob was a bunch of standard links: up, back, index, etc. -->
<PRE>MSG_PRINT_CONTROL_SET_OUTPUT, MSG_PRINT_CONTROL_GET_OUTPUT, MSG_PRINT_CONTROL_SET_DOC_NAME_OUTPUT, MSG_PRINT_CONTROL_GET_DOC_NAME_OUTPUT, MSG_PRINT_CONTROL_SET_DEFAULT_PRINTER, MSG_PRINT_CONTROL_GET_DEFAULT_PRINTER, MSG_PRINT_CONTROL_GET_PRINT_MODE, MSG_PRINT_CONTROL_GET_PAPER_SIZE, MSG_PRINT_CONTROL_GET_PRINTER_MARGINS, MSG_PRINT_CONTROL_CALC_DOC_DIMENSIONS, MSG_PRINT_CONTROL_VERIFY_DOC_MARGINS, MSG_PRINT_CONTROL_VERIFY_DOC_SIZE</PRE>
<P>
The Print Control handles many messages which allow the geode to retrieve and alter the values of the instance data.</P>

<H4 CLASS="RefETitle">
<A NAME="IX_MSG_PRINT_CONTROL_SET_OUTPUT">
 </A>
MSG_PRINT_CONTROL_SET_OUTPUT</H4>
<PRE CLASS="syntax">void 	MSG_PRINT_CONTROL_SET_OUTPUT(
        optr 	objectPtr);</PRE>
<P>
This message, used very rarely, specifies that a different object should become the Print Output. Pass the optr of the object to use.</P>
<P CLASS="refField">
Source:	Unrestricted.</P>
<P CLASS="refField">
Destination:	Any PrintControl object.</P>
<P CLASS="refField">
Parameters:	<EM>objectPtr</EM> 	The optr of the new <CODE>
PCI_output</CODE>
.</P>
<P CLASS="refField">
Return:	Nothing.</P>
<P CLASS="refField">
Interception:	Unlikely.</P>


<H4 CLASS="RefETitle">
<A NAME="IX_MSG_PRINT_CONTROL_GET_OUTPUT">
 </A>
MSG_PRINT_CONTROL_GET_OUTPUT</H4>
<PRE CLASS="syntax">optr 	MSG_PRINT_CONTROL_GET_OUTPUT();</PRE>
<P>
This message returns the optr of the Print Output.</P>
<P CLASS="refField">
Source:	Unrestricted.</P>
<P CLASS="refField">
Destination:	Any PrintControl object.</P>
<P CLASS="refField">
Parameters:	None.</P>
<P CLASS="refField">
Return:	The optr of the current <CODE>
PCI_output</CODE>
 object.</P>
<P CLASS="refField">
Interception:	Unlikely.</P>


<H4 CLASS="RefETitle">
<A NAME="IX_MSG_PRINT_CONTROL_SET_DOC_NAME_OUTPUT">
 </A>
MSG_PRINT_CONTROL_SET_DOC_NAME_OUTPUT</H4>
<PRE CLASS="syntax">void 	MSG_PRINT_CONTROL_SET_DOC_NAME_OUTPUT(
        optr 	document);</PRE>
<P>
This message, used very rarely, specifies that a different object should become the Document Name Output object. Pass the optr of the object to use.</P>
<P CLASS="refField">
Source:	Unrestricted.</P>
<P CLASS="refField">
Destination:	Any PrintControl object.</P>
<P CLASS="refField">
Parameters:	<EM>objectPtr</EM> 	The optr of the new <CODE>
PCI_docNameOutput</CODE>
.</P>
<P CLASS="refField">
Return:	Nothing.</P>
<P CLASS="refField">
Interception:	Unlikely.</P>


<H4 CLASS="RefETitle">
<A NAME="IX_MSG_PRINT_CONTROL_GET_DOC_NAME_OUTPUT">
 </A>
MSG_PRINT_CONTROL_GET_DOC_NAME_OUTPUT</H4>
<PRE CLASS="syntax">optr 	MSG_PRINT_CONTROL_GET_DOC_NAME_OUTPUT();</PRE>
<P>
This message returns the optr of the Document Name Output object.</P>
<P CLASS="refField">
Source:	Unrestricted.</P>
<P CLASS="refField">
Destination:	Any PrintControl object.</P>
<P CLASS="refField">
Parameters:	None.</P>
<P CLASS="refField">
Return:	The optr of the Document Name output object.</P>
<P CLASS="refField">
Interception:	Unlikely.</P>


<H4 CLASS="RefETitle">
<A NAME="IX_MSG_PRINT_CONTROL_SET_DEFAULT_PRINTER">
 </A>
MSG_PRINT_CONTROL_SET_DEFAULT_PRINTER</H4>
<PRE CLASS="syntax">void 	MSG_PRINT_CONTROL_SET_DEFAULT_PRINTER(
        int 	printerNum);		/* -1 for system's default printer */</PRE>
<P>
This message sets the application default printer, to be used the next time the print dialog box appears. Pass the printer number of the printer to use. Passing a value of -1 means that the system default printer should be used.</P>
<P CLASS="refField">
Source:	Unrestricted.</P>
<P CLASS="refField">
Destination:	Any PrintControl object.</P>
<P CLASS="refField">
Parameters:	<EM>printerNum</EM>	Number of the new default printer.</P>
<P CLASS="refField">
Return:	Nothing.</P>
<P CLASS="refField">
Interception:	Unlikely.</P>


<H4 CLASS="RefETitle">
<A NAME="IX_MSG_PRINT_CONTROL_GET_DEFAULT_PRINTER">
 </A>
MSG_PRINT_CONTROL_GET_DEFAULT_PRINTER</H4>
<PRE CLASS="syntax">int 	MSG_PRINT_CONTROL_GET_DEFAULT_PRINTER();</PRE>
<P>
Use this message to retrieve the number of the present application default printer. You may not assume that this printer is the one the user is printing on, since the user may have changed to another printer. A return value of -1 means that the application will use the system default printer.</P>
<P CLASS="refField">
Source:	Unrestricted.</P>
<P CLASS="refField">
Destination:	Any PrintControl object.</P>
<P CLASS="refField">
Parameters:	None.</P>
<P CLASS="refField">
Return:	The number of the default printer.</P>
<P CLASS="refField">
Interception:	Unlikely.</P>


<H4 CLASS="RefETitle">
<A NAME="IX_MSG_PRINT_CONTROL_GET_PRINT_MODE">
 </A>
MSG_PRINT_CONTROL_GET_PRINT_MODE</H4>
<PRE CLASS="syntax">byte 	MSG_PRINT_CONTROL_GET_PRINT_MODE(); </PRE>
<P>
This message retrieves the current user-selected print mode, if any. Its possible return values include zero, meaning no mode has been selected; PM_GRAPHICS_LOW_RES; PM_GRAPHICS_MED_RES; PM_GRAPHICS_HI_RES; PM_TEXT_DRAFT; and PM_TEXT_NLQ.</P>
<P CLASS="refField">
Source:	Unrestricted.</P>
<P CLASS="refField">
Destination:	Any PrintControl object.</P>
<P CLASS="refField">
Parameters:	None.</P>
<P CLASS="refField">
Return:	A <CODE>
PrinterOutputModes</CODE>
 signalling the printer's quality.</P>
<P CLASS="refField">
Interception:	Unlikely.</P>
<P CLASS="refField">
Structures:	The <A NAME="IX_PrinterOutputModes">
 </A>
<CODE>
PrinterOutputModes</CODE>
 structure has the following definition:</P>
<PRE>typedef ByteFlags PrinterOutputModes;</PRE>
<PRE>#define <A NAME="IX_POM_&ldots;"> </A>POM_GRAPHICS_LOW 0x10 
#define POM_GRAPHICS_MEDIUM 0x08 
#define POM_GRAPHICS_HIGH 0x04
#define POM_TEXT_DRAFT 0x02 
#define POM_TEXT_NLQ 0x01</PRE>
<P>
Each flag indicates the specified quality is available. Two useful masks which have been set up are PRINT_GRAPHICS and <A NAME="IX_PRINT_&ldots;">
 </A>
PRINT_TEXT.</P>


<H4 CLASS="RefETitle">
<A NAME="IX_MSG_PRINT_CONTROL_GET_PAPER_SIZE">
 </A>
MSG_PRINT_CONTROL_GET_PAPER_SIZE</H4>
<PRE CLASS="syntax">void 	MSG_PRINT_CONTROL_GET_PAPER_SIZE(
        PCMargineParams 		*retVal); </PRE>
<P>
Use this message to retrieve the Print Control's present paper size.</P>
<P CLASS="refField">
Source:	Unrestricted.</P>
<P CLASS="refField">
Destination:	Any PrintControl object.</P>
<P CLASS="refField">
Parameters:	<EM>
retVal</EM>
	An empty <CODE>
PCMarginParams</CODE>
 structure which the message handler will fill.</P>
<P CLASS="refField">
Return:	Nothing returned explicitly; the <EM>
retVal</EM>
 structure will be filled.</P>
<P CLASS="refField">
Interception:	Unlikely.</P>


<H4 CLASS="RefETitle">
<A NAME="IX_MSG_PRINT_CONTROL_GET_PAPER_SIZE_INFO">
 </A>
MSG_PRINT_CONTROL_GET_PAPER_SIZE_INFO</H4>
<PRE CLASS="syntax">void	MSG_PRINT_CONTROL_GET_PAPER_SIZE_INFO(
        PageSizeReport 	*ptr);</PRE>
<P>
Use this message to retrieve all of the information about the document size and orientation.</P>
<P CLASS="refField">
Source:	Unrestricted.</P>
<P CLASS="refField">
Destination:	Any PrintControl object.</P>
<P CLASS="refField">
Parameters:	<EM>ptr</EM> 	Pointer to an empty <CODE>
PageSizeReport </CODE>
structure which the message handler will fill in.</P>
<P CLASS="refField">
Return:	Nothing. </P>
<P CLASS="refField">
Interception:	Unlikely.</P>
<P CLASS="refField">
Structures:	The <CODE>
PageSizeReport</CODE>
 structure has the following definition:</P>
<PRE>typedef struct {
	dword			PSR_width;
	dword			PSR_height;
	PageLayout			PSR_layout;
	PCMarginParams 			PSR_margins;
} PageSizeReport;</PRE>


<H4 CLASS="RefETitle">
<A NAME="IX_MSG_PRINT_CONTROL_GET_PRINTER_MARGINS">
 </A>
MSG_PRINT_CONTROL_GET_PRINTER_MARGINS</H4>
<PRE CLASS="syntax">void 	MSG_PRINT_CONTROL_GET_PRINTER_MARGINS(
        MarginDimensions 		*retVal,
        Boolean 		setMargins); </PRE>
<P>
This message returns the margins enforced by the requested printer. If the boolean argument is <EM>
true</EM>
, the document margins will be set to be the same as the printer margins.</P>
<P CLASS="refField">
Source:	Unrestricted.</P>
<P CLASS="refField">
Destination:	Any PrintControl object.</P>
<P CLASS="refField">
Parameters:	<CODE>
setMargins</CODE>
	Pass TRUE to set the document's margins equal to the printer's margins, FALSE to leave the margins as they are.</P>
<DL>
<DT>
<CODE>
retVal</CODE>
</DT><DD>A pointer to an empty <CODE>
MarginDimensions</CODE>
 structure to be filled in by the handler.</DD>
</DL>
<P CLASS="refField">
Return:	The printer's enforced margins.</P>
<P CLASS="refField">
Structures:	The following structure keeps track of all four of a document's margins.</P>
<PRE><A NAME="IX_MarginDimensions"> </A>typedef struct {
	int 	leftMargin;		/* measured in points */
	int 	topMargin;
	int 	rightMargin;
	int 	bottomMargin;
} MarginDimensions;</PRE>
<P CLASS="refField">
Interception:	Unlikely.</P>


<H4 CLASS="RefETitle">
<A NAME="IX_MSG_PRINT_CONTROL_CALC_DOC_DIMENSIONS">
 </A>
MSG_PRINT_CONTROL_CALC_DOC_DIMENSIONS</H4>
<PRE CLASS="syntax">void 	MSG_PRINT_CONTROL_CALC_DOC_DIMENSIONS(
        PageSizeReport 	*ptr); </PRE>
<P>
This message calculates the maximum printable area allowed by the user-selected paper size and printer-mandated margins. This message automatically resets the document size and margins to hold these values.</P>
<P>
Note that this message correctly handles rotated pages.</P>
<P CLASS="refField">
Source:	Unrestricted.</P>
<P CLASS="refField">
Destination:	Any PrintControl object.</P>
<P CLASS="refField">
Parameters:	<EM>ptr</EM>	A pointer to a <CODE>
PageSizeReport </CODE>
structure to hold return value.</P>
<P CLASS="refField">
Return:	Nothing returned explicitly.</P>
<DL>
<DT>
<EM>ptr</EM></DT><DD>The pointer to the filled <CODE>
PageSizeReport </CODE>
structure.</DD>
</DL>
<P CLASS="refField">
Interception:	Unlikely.</P>


<H4 CLASS="RefETitle">
<A NAME="IX_MSG_PRINT_CONTROL_CHECK_IF_DOC_WILL_FIT">
 </A>
MSG_PRINT_CONTROL_CHECK_IF_DOC_WILL_FIT</H4>
<PRE CLASS="syntax">Boolean 	MSG_PRINT_CONTROL_CHECK_IF_DOC_WILL_FIT(
        Boolean 	warning); </PRE>
<P>
This message returns <EM>
true</EM>
 if the passed document margins will fit on the selected printer. </P>
<P CLASS="refField">
Source:	Unrestricted.</P>
<P CLASS="refField">
Destination:	Any PrintControl object.</P>
<P CLASS="refField">
Parameters:	<EM>warning</EM> 	If set, the PrintControl will deliver a warning to the user.</P>
<P CLASS="refField">
Return:	Indication of whether the printer can work with the current margins (<CODE>
true</CODE>
 if so, <CODE>
false</CODE>
 if not).</P>
<P CLASS="refField">
Interception:	Unlikely.<A NAME="marker=461127">
 </A>
</P>

<HR>
<!-- This blob is a bunch of standard links: up, back, index, etc. -->
<!-- up to top -->|&nbsp;<A HREF="../../index.htm"><IMG SRC="../../docImages/upTop.gif" ALT="Up: " BORDER="0">GEOS SDK TechDocs</A>
<!-- up to parent -->| <A HREF="Printing_f.htm"><IMG SRC="../../docImages/up.gif" ALT="Up" BORDER="0"></A>
<!-- down to first child --> 
<!-- to previous --> | <A HREF="Printing_11.htm"><IMG SRC="../../docImages/prev.gif" BORDER="0" ALT="Prev: ">5.2 Flow of Control Messages</A> 
<!-- to next --> | <A HREF="Printing_13.htm"><IMG SRC="../../docImages/nextUp.gif" BORDER="0" ALT="Next: ">6 Page Size Control</A> 
<HR>
<!-- That blob was a bunch of standard links: up, back, index, etc. -->
</BODY>
</HTML>
