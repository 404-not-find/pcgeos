<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>

<!-- $Id: 9000UI_7.htm,v 1.2 97/08/04 15:39:43 cgroom Exp $ -->
<META NAME="copyright" CONTENT="Copyright 1997 GEOWORKS">
<!-- <META NAME="description" CONTENT=""> -->
<!-- <META NAME="keywords" CONTENT=""> -->
<LINK REL="STYLESHEET" HREF="../../docHelpers/style.css">
<LINK REV="MADE" HREF="mailto:doc-feedback@geoworks.com">

<TITLE> ComplexMoniker Messages</TITLE></HEAD>
<BODY BGCOLOR="#ffffff">


<H1 CLASS="subsectionTitle">
<A HREF="index.htm">Communicator UI</A>: 2.3 <A HREF="9000UI_4.htm">ComplexMonikerClass</A>: 
<A NAME="74855">
 </A>
ComplexMoniker Messages</H1>
<!-- This blob is a bunch of standard links: up, back, index, etc. -->
<!-- up to top -->|&nbsp;<A HREF="../../index.htm"><IMG SRC="../../docImages/upTop.gif" ALT="Up: " BORDER="0">GEOS SDK TechDocs</A>
<!-- up to parent -->| <A HREF="9000UI_4.htm"><IMG SRC="../../docImages/up.gif" ALT="Up" BORDER="0"></A>
<!-- down to first child --> 
<!-- to previous --> | <A HREF="9000UI_6.htm"><IMG SRC="../../docImages/prev.gif" BORDER="0" ALT="Prev: ">2.2 ComplexMoniker Usage</A> 
<!-- to next --> | <A HREF="9000UI_8.htm"><IMG SRC="../../docImages/nextUp.gif" BORDER="0" ALT="Next: ">3 Convenient Dialog Routines</A> 
<HR>
<!-- That blob was a bunch of standard links: up, back, index, etc. -->
<PRE>MSG_COMPLEX_MONIKER_GET_MONIKER, MSG_COMPLEX_MONIKER_REPLACE_MONIKER</PRE>
<P>
To retrieve a complex moniker, send the ComplexMoniker <CODE>
MSG_COMPLEX_MONIKER_GET_MONIKER</CODE>
. This message takes a single argument, a pointer to a structure of type <CODE>
GetComplexMoniker</CODE>
. The structure will be filled in with the relevant information by the message.</P>
<PRE>typedef struct {
    TextStyle				GCM_textStyle;
    byte				GCM_fontSize;
    ComplexMonikerText				GCM_topText;
    ComplexMonikerBitmap				GCM_iconBitmap;
} GetComplexMoniker;</PRE>
<P>
Send <CODE>
MSG_COMPLEX_MONIKER_REPLACE_MONIKER</CODE>
 to replace a complex moniker with a new moniker.</P>
<P>
This message takes two arguments: a <CODE>
ReplaceComplexMoniker</CODE>
 structure and a <CODE>
ReplaceComplexMonikerChunkHandles</CODE>
 structure.</P>
<P>
The <CODE>
ReplaceComplexMoniker</CODE>
 structure should hold the parameters for the new moniker.</P>
<PRE>typedef struct {
    TextStyle				RCM_textStyleSet;
    TextStyle				RCM_textStyleClear;
    word				RCM_fontSize;
    dword				RCM_topTextSource;
    dword				RCM_iconBitmapSource;
    ComplexMonikerSourceType				RCM_topTextSourceType;
    ComplexMonikerSourceType				RCM_iconBitmapSourceType;
    word				RCM_iconBitmapSize;
    RCMOverwrite				RCM_overwrite;
} ReplaceComplexMoniker;</PRE>
<P>
RCM_<CODE>
textStyleSet</CODE>
 stores a <CODE>
TextStyle</CODE>
 record of styles that should be set (masked) on top of any currently existing styles.</P>
<P>
RCM<CODE>
_textStyleClear</CODE>
 stores a <CODE>
TextStyle</CODE>
 record of styles that should be cleared if they are set among the currently existing styles.</P>
<P>
RCM<CODE>
_fontSize</CODE>
 stores the new font size. Pass 0 to indicate no change.</P>
<P>
RCM<CODE>
_topTextSource</CODE>
 stores a dword value containing, or pointing to, the source for the new text. The type of value stored here is indicated in RCM<CODE>
_topTextSourceType</CODE>
.</P>
<P>
RCM<CODE>
_iconBitmapSource</CODE>
 stores a dword value containing, or pointing to, the source for the new bitmap. The type of value stored here is indicated in RCM<CODE>
_iconBitmapSourceType.</CODE>
</P>
<P>
RCM_<CODE>
topTextSourceType</CODE>
 stores the type of text reference contained in RCM_<CODE>
topTextSource</CODE>
. </P>
<P>
RCM<CODE>
_iconBitmapSourceType</CODE>
 stores the type of bitmap reference contained in RCM_<CODE>
iconBitmapSource</CODE>
.</P>
<P>
<CODE>
RCM_iconBitmapSize</CODE>
 stores the size of the icon bitmap, in bytes. </P>
<P>
RCM<CODE>
_overwrite</CODE>
 indicates whether the existing complex moniker chunks should be overwritten. Pass TRUE if you wish this occur.</P>
<P>
<CODE>
MSG_COMPLEX_MONIKER_REPLACE_MONIKER</CODE>
 also passes a <CODE>
ReplaceComplexMonikerChunkHandles</CODE>
 structure. This structure is used to place returned chunk handles of the text and bitmap.</P>
<PRE>typedef struct {
    ChunkHandle			RCMCH_topText;
    word			RCMCH_unusedCX;
    ChunkHandle			RCMCH_iconBitmap;
    word			RCMCH_unusedBP;
} ReplaceComplexMonikerChunkHandles;</PRE>
<P>
<CODE>
RCMCH</CODE>
_<CODE>
topText</CODE>
 contains the ChunkHandle of the text portion of the new complex moniker. </P>
<P>
RCMCH<CODE>
_iconBitmap</CODE>
 contains the ChunkHandle of the bitmap (graphics) portion of the new complex moniker.</P>
<HR>
<!-- This blob is a bunch of standard links: up, back, index, etc. -->
<!-- up to top -->|&nbsp;<A HREF="../../index.htm"><IMG SRC="../../docImages/upTop.gif" ALT="Up: " BORDER="0">GEOS SDK TechDocs</A>
<!-- up to parent -->| <A HREF="9000UI_4.htm"><IMG SRC="../../docImages/up.gif" ALT="Up" BORDER="0"></A>
<!-- down to first child --> 
<!-- to previous --> | <A HREF="9000UI_6.htm"><IMG SRC="../../docImages/prev.gif" BORDER="0" ALT="Prev: ">2.2 ComplexMoniker Usage</A> 
<!-- to next --> | <A HREF="9000UI_8.htm"><IMG SRC="../../docImages/nextUp.gif" BORDER="0" ALT="Next: ">3 Convenient Dialog Routines</A> 
<HR>
<!-- That blob was a bunch of standard links: up, back, index, etc. -->
</BODY>
</HTML>
