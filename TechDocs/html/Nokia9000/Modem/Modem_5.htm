<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">
<HTML>
<HEAD>

<!-- $Id: Modem_5.htm,v 1.1 97/06/05 12:41:02 lawrence Exp $ -->
<META NAME="copyright" CONTENT="Copyright 1997 GEOWORKS">
<!-- <META NAME="description" CONTENT=""> -->
<!-- <META NAME="keywords" CONTENT=""> -->
<LINK REL="STYLESHEET" HREF="../../docHelpers/style.css">
<LINK REV="MADE" HREF="mailto:doc-feedback@geoworks.com">

<TITLE> Disconnecting</TITLE></HEAD>
<BODY BGCOLOR="#ffffff">


<H1 CLASS="sectionTitle">
<A HREF="index.htm">Modem Connections</A>: 5 
<A NAME="89498">
 </A>
Disconnecting</H1>
<!-- This blob is a bunch of standard links: up, back, index, etc. -->
<!-- up to top -->|&nbsp;<A HREF="../../index.htm"><IMG SRC="../../docImages/upTop.gif" ALT="Up: " BORDER="0">GEOS SDK TechDocs</A>
<!-- up to parent -->| <A HREF="index.htm"><IMG SRC="../../docImages/up.gif" ALT="Up" BORDER="0"></A>
<!-- down to first child --> 
<!-- to previous --> | <A HREF="Modem_4.htm"><IMG SRC="../../docImages/prev.gif" BORDER="0" ALT="Prev: ">4 Receiving Data</A> 
<!-- to next --> 
<HR>
<!-- That blob was a bunch of standard links: up, back, index, etc. -->
<P>
When a call has ended, the modem driver sends a pre-registered message to a specified object. (You specify both the message and the receiving object in <CODE>
ModemConnect()</CODE>
.)</P>
<P>
In the MTalk example, the modem driver sends MSG_MTALK_PROCESS_CALL_ENDED to the process object when the call has ended for any reason. This message checks if the connection is still open and if it is, calls yet another message, MSG_MTALK_PROCESS_CLOSE, to close it. The handler for MSG_MTALK_PROCESS_CLOSE is shown in <A HREF="Modem_5.htm#96554"> Ending A Serial Line Connection</A>
.</P>
<P CLASS="figTitle">
Code Display 9-4 <A NAME="96554">
 </A>
Ending A Serial Line Connection</P>
<PRE>@method MTalkProcessClass, MSG_MTALK_PROCESS_CLOSE
{
	/* close the connection */
    ModemDisconnect();</PRE>
<PRE>	/*
	 * Free the buffer and re-set the (global) &quot;connection&quot; flag
	 * to indicate the connection is closed.
	 */
    MemFree( recvBuffer );
    recvBuffer = NullHandle;
    ConnectionOpen = FALSE;</PRE>
<PRE>} /* end of MSG_MTALK_PROCESS_CLOSE */</PRE>
<P>
<CODE>
ModemDisconnect()</CODE>
, defined in modem.goc, takes care of the following:</P>
<UL>
<LI>
hangs up the phone</LI>
<LI>
closes the &quot;virtual&quot; serial port</LI>
</UL>
<P>
<CODE>
ModemDisconnect()</CODE>
 takes no parameters and returns void.</P>
<P>
&nbsp;</P>
<HR>
<!-- This blob is a bunch of standard links: up, back, index, etc. -->
<!-- up to top -->|&nbsp;<A HREF="../../index.htm"><IMG SRC="../../docImages/upTop.gif" ALT="Up: " BORDER="0">GEOS SDK TechDocs</A>
<!-- up to parent -->| <A HREF="index.htm"><IMG SRC="../../docImages/up.gif" ALT="Up" BORDER="0"></A>
<!-- down to first child --> 
<!-- to previous --> | <A HREF="Modem_4.htm"><IMG SRC="../../docImages/prev.gif" BORDER="0" ALT="Prev: ">4 Receiving Data</A> 
<!-- to next --> 
<HR>
<!-- That blob was a bunch of standard links: up, back, index, etc. -->
</BODY>
</HTML>
