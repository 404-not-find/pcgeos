$Id: functions,v 1.2.18.1 97/03/29 03:48:45 canavese Exp $


Financial Functions
-------------------

p = principal
i = interest rate
n = term

IRR

NPV
                 n    vj
        NPV =   SUM -------
                j=1 (1+i)^j

FV
                    (1 + i)^n - 1
        FV =    p * -------------
                         i

PMT
                          i
        PMT =   p * --------------
                    1 - (i + 1)^-n

PV
        PV =    p * (1 - (1 + i)^-n) / i

TERM
                ln(1 + (f*i/p))
        TERM =  ---------------
                  ln(1 + i)

CTERM
                ln( fv/pv)
        CTERM = -----------
                ln(1 + int)

RATE
        RATE =  (fv/pv)^(1/n) - 1

Math and Trig Functions
-----------------------

ACOSH
ASINH
ATANH
COSH
SINH
TANH



1) future value

	FV(payments, interest, term) calculates the future value
	of an investment, based on a series of equal payments,
	earning a periodic interest rate, over the number of
	payment periods in term.

	Let p = periodic payment
	    i = interest rate
	    n = number of periods

		    (1 + i)^n - 1
	FV =    p * -------------
			 i

2) internal rate of return

	IRR(guess, range) calculates the internal rate of return
	expected from a series of cash flows generated by an investment.
	The internal rate of return is the percentage rate at which the
	present value of an expected series of cash flows is
	equal to the present value of the initial investment.
	The cash flow is assumed to be received at regualr, equal
	intervals.

	NPV(IRR(range), range) = 0

	IRR uses the order of values to interpret the order of cash
	flows.

	Guess represents the estimate of the internal rate of return.
	Guess can be any value greater than 0 (0%) and less than 1
	(100%).

	Range can be the name or address of the range that contains
	the cash flows. Negative numbers are considered as cash
	outflows and positive numbers as cash inflows. The first
	number in the range is normally negative representing the
	investment.

	Starting with guess, IRR cycles through the calculation until
	the result is accurate to within 0.00001%.  If IRR cannot find
	a result that works after 20 tries, the #VALUE! error value is
	returned.

	NOTES
	-----
	IRR is closely related to NPV.  The rate of return calculated
	by IRR is the interest rate corresponding to a zero net
	present value.  NPV(IRR(range), range) = 0.

	PSEUDO CODE/STRATEGY:
	---------------------
	adopt a binary search strategy using NPV
	attempt to head toward 0

	more detailed:

	if the guess is missing, use 10%
	else error check guess

	oldguess = 100%

	for i = 1 to 20 do
	    if (npv=NPV(guess, range)) <= 0.00001% then
		break;
	    else if npv < 0 then
		want smaller guess
		guess = guess - abs((guess-oldguess)/2);
	    else
		want larger guess
		guess = guess + abs((guess-oldguess)/2);
	    endif
	end for

	if found then return result
	else return error

3) net present value

	NPV(interest, range) calculates the net present value of
	a series of future cash flows discounted at a fixed,
	periodic interest rate.

	Let v1...vn = series of cash flows in the range
	    int = interest rate
	    n = number of cash flows
	    i = the current iteration of 1 through n
		 n       vi
	NPV =   SUM  -----------
		i=1  (1 + int)^i

4) payment

	PMT(principal, interest, term) calculates the amount of the
	periodic payment needed to pay off a loan, given a periodic
	interest rate and number of payment periods.  It is assumed
	that the payments are made at the end of each payment period.

	Let p = principal
	    i = periodic interest rate
	    n = term

			  i
	PMT =   p * --------------
		    1 - (i + 1)^-n

5) present value

	PV(payments, interest, term) determines the present value
	of an investment.  PV calculates the present value based
	on a series of equal payments, discounted at a periodic
	interest rate over the number of periods.

	Let p = periodic payment
	    i = periodic interest rate
	    n = term
	PV = p * (1 - (1 + i)^-n) / i

6) rate

	RATE(future-value, present-value, term) calculates the
	periodic interest rate necessary for an investment to grow
	to a future-value over the number of compounding periods in
	term.

	Let fv = future value
	    pv = present value
	    n = term

	RATE =  (fv/pv)^(1/n) - 1
